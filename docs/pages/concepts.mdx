# Klaster Core Concepts

Klaster introduces several novel concepts to enable multi-chain transactions and improve blockchain interoperability. This document explains four key concepts: Interchain Transactions, Public Execution Network, Multichain Smart Contract Accounts, and Execution Commitments.

## Interchain Transaction (iTx)

An Interchain Transaction (iTx) is a fundamental building block in the Klaster ecosystem. It represents a bundle of one or more blockchain transactions that can be executed across multiple blockchain networks.

### Key Features:
- **Merkle Tree Encoding**: Each iTx is encoded as a Merkle Tree of "child" transactions.
- **iTx Hash**: The root hash of the Merkle Tree serves as the unique identifier for the iTx.
- **Multiple Transactions**: An iTx can contain any number of regular blockchain transactions.
- **EVM Compatibility**: For EVM chains, iTx typically uses ERC4337 UserOp objects with additional metadata.

### Additional Metadata for EVM Chains:
- `ChainID`: Specifies the target blockchain for execution.
- `Salt`: Determines which derived Multichain Smart Account to use.
- `Minimum Block Height`: Sets the earliest block for transaction execution.

## Public Execution Network (PEN)

The Public Execution Network is Klaster's peer-to-peer (P2P) network responsible for executing Interchain Commitments.

### Key Components:
1. **Economic Security**: Uses staked or re-staked tokens to ensure execution guarantees.
2. **Node Types**:
   - **Light Nodes**: 
     - Don't execute transactions
     - Handle auxiliary tasks like gas cost simulation
     - Maintain lists of full-node peers
   - **Full Nodes**:
     - Generate Interchain Commitments
     - Have staked tokens in StakeManager contracts
     - Actively execute Interchain Transactions on one or more chains

## Multichain Smart Contract Accounts

Multichain Smart Contract Accounts extend the concept of Smart Contract Accounts to operate seamlessly across multiple blockchains.

### Key Features:
- **Deterministic Address Derivation**: Provides consistent addresses across all supported blockchains.
- **dApp Integration**: Allows dApps to interact with the same user account across different chains.
- **Scalability**: Users can derive multiple Multichain Smart Accounts from a single "master" account.
- **Customization**: Uses a Salt parameter for flexible account derivation.

## Execution Commitments

Execution Commitments are a crucial part of Klaster's security model, ensuring that transactions are executed as promised.

### Process:
1. **Commitment Generation**: 
   - Full Node signs the iTx Merkle Tree root hash.
   - This signature commits the node to execute all transactions in the iTx.

2. **User Approval**:
   - User signs the same Merkle Tree root hash.
   - This signature authorizes the Klaster PEN to commit transactions to the blockchain(s).

3. **Dual Signatures**:
   - **Signed Node Commitment**: Used for potential slashing if node fails to execute.
   - **Signed User Approval**: Allows Klaster PEN to process the transactions.

4. **Distribution**:
   - Both signatures are distributed to the Committing Node and Witness Nodes in the Klaster PEN.

### Security Guarantees:
- Protects against fraudulent transactions
- Provides censorship resistance
- Ensures liveness of the network

By combining these concepts, Klaster creates a robust framework for executing multi-chain transactions with improved security and user experience.